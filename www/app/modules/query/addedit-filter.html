<div ng-controller="QueryAddEditFilterCtrl">
  <div class="os-query-addedit-filter-po os-no-label-form">
    <div class="form-group">
      <label for="operator" translate="queries.operator">
        Operator
      </label>
      <os-select ng-model="queryLocal.currFilter.op"
        list="queryLocal.currFilter.ops" display-prop="desc"
        placeholder="{{'queries.select_op' | translate}}"
        on-change="onOpSelect">
      </os-select>
    </div>

    <div class="form-group" ng-hide="queryLocal.currFilter.unaryOp">
      <label for="value" translate="queries.cond_value">
        Condition Value
      </label>
      <div id="value" ng-switch on="queryLocal.currFilter.valueType">
        <div ng-switch-when="select">
          <os-select ng-model="queryLocal.currFilter.value"
            list="queryLocal.currFilter.field.pvs" refresh="searchPv"
            placeholder="{{'queries.select_cond_value' | translate}}">
          </os-select>
        </div>
        <div ng-switch-when="multiSelect">
          <div class="form-group">
            <label class="checkbox-inline">
              <input type="checkbox" ng-model="queryLocal.currFilter.hasSq"
                ng-checked="queryLocal.currFilter.hasSq" ng-change="onSqToggle(queryLocal.currFilter)">
              <span translate="queries.select_subquery">Select Query</span>
            </label>
          </div>
          <span ng-if="!!queryLocal.currFilter.hasSq">
            <os-select ng-model="queryLocal.currFilter.subQuery" display-prop="title"
              list="savedQueries" refresh="searchQuery"
              placeholder="Select Query" on-select="loadQueryDef(queryLocal.currFilter)">
            </os-select>
          </span>
          <span ng-if="!queryLocal.currFilter.hasSq">
            <os-select multiple
              ng-model="queryLocal.currFilter.value"
              list="queryLocal.currFilter.field.pvs" refresh="searchPv"
              placeholder="{{'queries.select_cond_values' | translate}}">
            </os-select>
          </span>
        </div>
        <div ng-switch-when="tagsSelect">
          <div class="form-group">
            <label class="checkbox-inline">
              <input type="checkbox" ng-model="queryLocal.currFilter.hasSq"
                ng-checked="queryLocal.currFilter.hasSq" ng-change="onSqToggle(queryLocal.currFilter)">
              <span translate="queries.select_subquery">Select Query</span>
            </label>
          </div>
          <span ng-if="!!queryLocal.currFilter.hasSq">
            <os-select ng-model="queryLocal.currFilter.subQuery" display-prop="title"
              list="savedQueries" refresh="searchQuery"
              placeholder="Select Query" on-select="loadQueryDef(queryLocal.currFilter)">
            </os-select>
          </span>
          <span ng-if="!queryLocal.currFilter.hasSq">
            <textarea class="form-control" placeholder="{{'queries.specify_multiple_cond' | translate}}" rows="2"
              ng-model="queryLocal.currFilter.value" os-enable-tab>
            </textarea>
          </span>
        </div>
        <div ng-switch-when="betweenDate" class="clearfix os-query-range-value">
          <input class="form-control" placeholder="{{'queries.range_min' | translate}}" 
            type="text" os-query-date-picker="{{global.queryDateFmt}}"
            ng-model="queryLocal.currFilter.value[0]">
          <span>and</span>
          <input class="form-control" placeholder="{{'queries.range_max' | translate}}" 
            type="text" os-query-date-picker="{{global.queryDateFmt}}"
            ng-model="queryLocal.currFilter.value[1]">
        </div>
        <div ng-switch-when="betweenNumeric" class="clearfix os-query-range-value">
          <input class="form-control" placeholder="{{'queries.range_min' | translate}}" 
            type="text" ng-model="queryLocal.currFilter.value[0]">
          <span>and</span>
          <input class="form-control" placeholder="{{'queries.range_max' | translate}}" 
            type="text" ng-model="queryLocal.currFilter.value[1]">
        </div>
        <div ng-switch-when="lookupSingle">
          <input type="hidden" 
            os-lookup opts="queryLocal.currFilter.field.lookupProps" 
            placeholder="{{'queries.select_cond_value' | translate}}"
            ng-model="queryLocal.currFilter.value">
          </input>
        </div>
        <div ng-switch-when="lookupMultiple">
          <input type="hidden" 
            os-lookup opts="queryLocal.currFilter.field.lookupProps" multiple
            placeholder="{{'queries.select_cond_values' | translate}}"
            ng-model="queryLocal.currFilter.value">
          </input>
        </div>
        <input ng-switch-when="datePicker" class="form-control"
          placeholder="{{'queries.select_date' | translate}}"
          type="text" os-query-date-picker="{{global.queryDateFmt}}"
          ng-model="queryLocal.currFilter.value"></input>
        <input ng-switch-default class="form-control"
          placeholder="{{'queries.specify_cond' | translate}}"
          type="text" ng-model="queryLocal.currFilter.value">
        </input>
      </div>
    </div>

    <div class="form-group" ng-if="!queryLocal.currFilter.hasSq">
      <label class="checkbox-inline">
        <input type="checkbox" ng-model="queryLocal.currFilter.parameterized" 
          ng-checked="queryLocal.currFilter.parameterized">
          <span translate="queries.parameterized_filter">Parameterized Filter</span>
      </label>

      <label class="checkbox-inline" ng-if="queryLocal.currFilter.field.type == 'STRING'">
        <input type="checkbox" ng-model="queryLocal.currFilter.hideOptions"
          ng-checked="queryLocal.currFilter.hideOptions">
        <span translate="queries.hide_filter_values">Hide Options</span>
      </label>
    </div>

    <div class="form-group"> 
      <button class="btn btn-success" ng-disabled="disableAddEditFilterBtn()" 
        ng-click="addFilter()" ng-if="!queryLocal.currFilter.id">
        <span translate="common.buttons.add">Add</span>
      </button>
      <button class="btn btn-success" ng-disabled="disableAddEditFilterBtn()" 
        ng-click="editFilter()" ng-if="queryLocal.currFilter.id">
        <span translate="common.buttons.edit">Edit</span>
      </button>
      <button class="btn btn-default" ng-click="cancelFilter()">
        <span translate="common.buttons.cancel">Cancel</span>
      </button>
    </div>
  </div>
</div>
