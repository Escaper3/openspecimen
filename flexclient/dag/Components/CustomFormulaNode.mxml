<?xml version="1.0" encoding="utf-8"?>
<mx:Box xmlns:mx="http://www.adobe.com/2006/mxml"  borderThickness="2" width="325" height="80"  color="black" backgroundColor="white" borderColor="#0000FF" borderStyle="solid">
  <mx:Script>
  	<![CDATA[
        import mx.controls.Menu;
        import mx.events.MenuEvent;
        import mx.controls.Alert;
        import Components.DAGConstants;
        import mx.rpc.events.ResultEvent;
         
  		[Bindable]
  		public var customFormula : String = null;
  		
  		[Bindable]
		public var menuData:Array = [	
		{label: "Edit", type: "radio", toggled: false,enabled:true},
		{label: "Delete", type: "radio", toggled: false,enabled:true}
		
		];
		
  		public function initializeNode(x:int,y:int,name :String) : void
  		{
  			this.x = x;
  			this.y = y;
  			this.name = name; 
  		}
  		
  		private function createMenu(event:MouseEvent):void
  		{
  			var myMenu:Menu=null;
  			myMenu = Menu.createMenu(this, menuData, true);
  			myMenu.show(event.stageX,event.stageY);
			myMenu.addEventListener(MenuEvent.ITEM_CLICK,handleMenuEvent);

  	   }
  	   
  	   private function handleMenuEvent(event:MenuEvent):void
  	   { 	
  	   	  
  	   	  if(event.label == DAGConstants.DELETE)
  	   	  {
  	   	      //To delete the Custom Formula Node	
  	   	      deleteCustomNode();
  	   	  }
  	   	  else
  	   	  {
  	   	  	  editCustomFormula();
  	   	  }
  	   }
  	   private function deleteCustomNode() : void
  	   {
  	   	  rpcService.removeCustomFormula();
          rpcService.addEventListener(ResultEvent.RESULT,nodeRemoveHandler)
  	   }
  	   private function nodeRemoveHandler(event : ResultEvent) : void
  	   {
  	   	  
  	   	 
  	   	  var customNodeName : String = this.name; 
  	   	  //Deriving line object Names which attaches the DagNode and Custom formula node
          var nodesNumbers : Array = customNodeName.split("_");
          var line1 : String = nodesNumbers[0] + "_" + customNodeName;    	   	  
  	   	  var line2 : String = nodesNumbers[1] + "_" + customNodeName;
  	     
  	      //Deleting the Custom Formula Node and corresponding connecting Nodes 
          this.parentApplication.deleteCustomNode(customNodeName,line1,line2);  	   
  	   }
  	   private function editCustomFormula() : void
  	   {
  	   	  Alert.show("This functionality is not yet Supported");
  	   } 
  	]]>
  </mx:Script>
 
  <mx:RemoteObject id="rpcService" destination="cdeService">
 </mx:RemoteObject>
  
  <mx:HBox height="100%" width="100%" textAlign="center">
     <mx:Label id="formulaLabel" text="{customFormula}" height="100%" width="95%"/>
  	
     <mx:Button  label=">" width="5%" click="createMenu(event)"/>	
  </mx:HBox> 
  
</mx:Box>
