<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:local="*"  
	xmlns:adobe="http://www.adobe.com/2006/fc" preinitialize="preInit()" creationComplete="creationComp()" xmlns:components="components.*" xmlns:components1="flexclient.multiplespecimen.components.*" borderStyle="solid" paddingLeft="5" paddingRight="5">
<mx:Script source="../script/validate.as"/>
<mx:Script>
	<![CDATA[
		import util.MetadataModel;
		import util.Utility;
		import util.Constants;
		import valueobjects.SpecimenData;
		import mx.binding.utils.BindingUtils;
		import mx.controls.Alert;
		import mx.collections.ArrayCollection;
		import mx.managers.PopUpManager;
		[Bindable]
		public var derivedData:SpecimenData ;
	
		private function preInit():void
		{
			
			
			
		}
		private function creationComp():void
		{
			switchSpType(null);
			//Check box
			Utility.bindData(isCopy, "selected", derivedData, "isSelected");

			//Label
			Utility.bindData(spLabel, "text", derivedData,"specimenLabel");
			
			//Barcode
			Utility.bindData(spBarCode, "text", derivedData, "specimenBarcode");
		
			//Specimen Class
			Utility.bindData(spClass, "selectedItem", derivedData, "specimenClass");
			
			//Specimen Type
			Utility.bindData(spType, "selectedItem", derivedData, "specimenType");

			//Bind Creation date
			Utility.bindData(spCreatedOn,"selectedDate",derivedData,"creationDate");
			
			//Bind Quantity
			Utility.bindData(spQuantity,"text",derivedData,"quantity");
			
			//Bind Concentration
			Utility.bindData(spConcentration,"text",derivedData,"concentration");
			//bindData(spQuantity,"restrict",spConcentration,"text",false);
			
			//Bind Comments
			Utility.bindData(spComment, "text", derivedData, "comment");

		}
		
		private function switchSpType(event:Event):void
		{
			derivedData.specimenTypePVList = MetadataModel.getInstance().getSpecimenTypeCollection(derivedData.specimenClass);
			derivedData.calcUnit();
		}
		
		private function printSpDetails(derivedData:SpecimenData):void
		{
			Alert.show("SPECIMEN DETAILS: \n"+
					   "scgName: "+derivedData.scgName+"\n"+
					   "parentSpecimenName: "+derivedData.parentSpecimenName+"\n"+
					   "specimenLabel: "+derivedData.specimenLabel+"\n"+
					   "specimenBarcode: "+derivedData.specimenBarcode+"\n"+
					   "specimenClass: "+derivedData.specimenClass+"\n"+
					   "specimenType: "+derivedData.specimenType+"\n"+
					   "tissueSite: "+derivedData.tissueSite+"\n"+
					   "tissueSide: "+derivedData.tissueSide+"\n"+
					   "pathologicalStatus: "+derivedData.pathologicalStatus+"\n"+
					   "creationDate: "+derivedData.creationDate+"\n"+
					   "quantity: "+derivedData.quantity+"\n"+
					   "concentration: "+derivedData.concentration);
		}
		
		
		
   		
   	
   		
   		
/*   		public function validateSpecimen(index:int):Boolean
   		{
   			var isValid:Boolean = true;
   			var specimenNumber :String = " for specimen "+index;
   			isValid= validateRequiredField(spLabel,"text","Please enter label") && isValid;
   			isValid= validateRequiredField(spBarCode,"text","Please enter barcode") && isValid;

			isValid = validateComboBoxField(spClass,"selectedItem","Please select class") && isValid;
			isValid = validateComboBoxField(spType,"selectedItem","Please select type") && isValid;
			isValid = validateComboBoxField(spTissueSite,"selectedItem","Please select tissue site") && isValid;			
			isValid = validateComboBoxField(spTissueSide,"selectedItem","Please select tissue side") && isValid;			
			isValid = validateComboBoxField(spPathologicalStatus,"selectedItem","Please select pathological status") && isValid;			
			
   			isValid =  validateNumberField(spQuantity,"text","Please enter Quantity",true,0) && isValid;
   			isValid =  validateNumberField(spConcentration,"text","Please enter concentration",true,0) && isValid;
			if(colledtedEventPane != null)
   			{
	   			isValid = colledtedEventPane.collectedEventContentPane.validateCollEvent(index) && isValid;
   			}
   			if(receivedEventPane != null)
   			{
				isValid= receivedEventPane.receivedEventContentPane.validateRecvEvent(index) && isValid;
   			}
		
			if(exIDPane != null)
			{
				isValid = exIDPane.validateExIds(index) && isValid;
			}
			if(biohazardPane != null)
			{
				isValid = biohazardPane.validateBiohazards(index) && isValid;
					
			}
			return isValid;
		}                     
*/
	


	]]>
</mx:Script>
	

<components:MyCanvas>
		<mx:CheckBox id="isCopy" />
	</components:MyCanvas>
	
	<components:MyCanvas>
		<mx:TextInput id="spLabel"/>
	</components:MyCanvas>
	
	
	<components:MyCanvas>
		<adobe:AutoComplete id="spClass" dataProvider="{MetadataModel.getInstance().specimenClassPVList}" change="switchSpType(event)"/>
	</components:MyCanvas>
		
	<components:MyCanvas>
		<adobe:AutoComplete id="spType" dataProvider="{derivedData.specimenTypePVList}" lookAhead="true"/>
	</components:MyCanvas>

	
	<components:MyCanvas>
		<mx:DateField id="spCreatedOn" formatString="{Constants.DATE_FORMAT}" keyDown="spCreatedOn.open()"/>
	</components:MyCanvas>
	<components:MyCanvas>
		<mx:HBox>
			<mx:TextInput id="spConcentration" width="50" restrict="[0-9]."/>
			<mx:Label htmlText="{Constants.UNIT_CONCENTRATION}"/>
		</mx:HBox>
	</components:MyCanvas>
	
	<components:MyCanvas>
		<mx:HBox>
			<mx:TextInput id="spQuantity" width="50" restrict="[0-9]."/>
			<mx:Label text="{derivedData.unit}"/>
		</mx:HBox>
	</components:MyCanvas>
		<components:MyCanvas>
		<mx:TextInput id="spBarCode"/>
	</components:MyCanvas>
	
	<components:MyCanvas>
		<mx:TextArea id="spComment"/>
	</components:MyCanvas>
	
</mx:VBox>