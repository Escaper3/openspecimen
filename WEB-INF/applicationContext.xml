<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:context="http://www.springframework.org/schema/context"
  xmlns:p="http://www.springframework.org/schema/p"
  xmlns:c="http://www.springframework.org/schema/c"
  xmlns:util="http://www.springframework.org/schema/util"
  xmlns:tx="http://www.springframework.org/schema/tx"
  xmlns:aop="http://www.springframework.org/schema/aop"
  xsi:schemaLocation="http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
    http://www.springframework.org/schema/tx
    http://www.springframework.org/schema/tx/spring-tx-3.2.xsd
    http://www.springframework.org/schema/aop 
    http://www.springframework.org/schema/aop/spring-aop-3.2.xsd
    http://www.springframework.org/schema/context 
           http://www.springframework.org/schema/context/spring-context-3.2.xsd">

  
  
  <bean id="daoConfigFactory" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
   <property name="targetClass"><value>edu.wustl.dao.daofactory.DAOConfigFactory</value></property>
   <property name="targetMethod"><value>getInstance</value></property>
  </bean>
 
  <bean id="sessionFactoryBuilder" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
   <property name="targetObject"><ref local="daoConfigFactory"/></property>
   <property name="targetMethod"><value>getDAOFactory</value></property>
  </bean>

  <bean id="biospecimenDaoFactory" class="com.krishagni.catissueplus.core.biospecimen.repository.impl.DaoFactoryImpl">
    <property name="sessionFactory" value="#{sessionFactoryBuilder.getSessionFactory()}"/>
  </bean>
  
    
  <aop:aspectj-autoproxy />
  
  <bean id="serviceInterceptor" class="com.krishagni.catissueplus.core.common.TransactionalInterceptor">
    <property name="sessionFactory" value="#{sessionFactoryBuilder.getSessionFactory()}"/>
  </bean>
  
  <!-- bean id="collectionProtocolDao" class="com.krishagni.catissueplus.dao.impl.CollectionProtocolDaoImpl">
    <property name="daoFactory" value="daoFactory"/>  
  </bean>
  
  <bean id="collectionProtocolRegistrationDao" class="com.krishagni.catissueplus.dao.impl.CollectionProtocolRegistrationDaoImpl">
    <property name="sessionFactory" value="#{sessionFactoryBuilder.getSessionFactory()}"/>  
  </bean>
  
  <bean id="specimenCollectionGroupDao" class="com.krishagni.catissueplus.dao.impl.SpecimenCollectionGroupDaoImpl">
    <property name="sessionFactory" value="#{sessionFactoryBuilder.getSessionFactory()}"/>  
  </bean>
  
  <bean id="specimenDao" class="com.krishagni.catissueplus.dao.impl.SpecimenDaoImpl">
    <property name="sessionFactory" value="#{sessionFactoryBuilder.getSessionFactory()}"/>  
  </bean-->
  
  <bean id="collectionProtocolService" class="com.krishagni.catissueplus.core.biospecimen.services.impl.CollectionProtocolServiceImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
  </bean>
  
  <bean id="specimenCollGroupService" class="com.krishagni.catissueplus.core.biospecimen.services.impl.SpecimenCollGroupServiceImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
  </bean>
  
  <bean id="cpSvc" class="com.krishagni.catissueplus.core.biospecimen.services.impl.CollectionProtocolServiceImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
  </bean>
  
  <bean id="participantFactory" class="com.krishagni.catissueplus.core.biospecimen.domain.factory.impl.ParticipantFactoryImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
  </bean>
  <bean id="specimenFactory" class="com.krishagni.catissueplus.core.biospecimen.domain.factory.impl.SpecimenFactoryImpl">
  </bean>
  <bean id="scgFactory" class="com.krishagni.catissueplus.core.biospecimen.domain.factory.impl.SpecimenCollectionGroupFactoryImpl">
    <property name="specimenFactory" ref="specimenFactory"/>
  </bean>
  <bean id="cprFactory" class="com.krishagni.catissueplus.core.biospecimen.domain.factory.impl.CollectionProtocolRegistrationFactoryImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
    <property name="participantFactory" ref="participantFactory"/>
    <property name="scgFactory" ref="scgFactory"/>
  </bean>
  <bean id="participantSvc" class="com.krishagni.catissueplus.core.biospecimen.services.impl.ParticipantServiceImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
    <property name="participantFactory" ref="participantFactory"/>
  </bean>
  
  <bean id="cprSvc" class="com.krishagni.catissueplus.core.biospecimen.services.impl.CollectionProtocolRegistrationServiceImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
    <property name="registrationFactory" ref="cprFactory"/>
    <property name="participantFactory" ref="participantFactory"/>
  </bean>

  <bean id="userFact" class="com.krishagni.catissueplus.core.administrative.domain.factory.impl.UserFactoryImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
  </bean>

  <bean id="userSvc" class="com.krishagni.catissueplus.core.administrative.services.impl.UserServiceImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
    <property name="userFactory" ref="userFact"/>	
  </bean>	

  <bean id="specimenSvc" class="com.krishagni.catissueplus.core.biospecimen.services.impl.SpecimenServiceImpl">
    <property name="daoFactory" ref="biospecimenDaoFactory"/>
  </bean>

  <bean id="formDao" class="com.krishagni.catissueplus.core.de.repository.impl.FormDaoImpl">
    <property name="sessionFactory" value="#{sessionFactoryBuilder.getSessionFactory()}"/> 
  </bean>
  
  <bean id="formSvc" class="com.krishagni.catissueplus.core.de.services.impl.FormServiceImpl">
    <property name="formDao" ref="formDao"/>
  </bean>

  <bean id="querySvc" class="com.krishagni.catissueplus.core.de.services.impl.QueryServiceImpl">
  </bean>

 </beans>
