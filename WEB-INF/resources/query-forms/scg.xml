#macro( getMessage $code )
  $messageSource.getMessage($code, null, $locale)
#end

<form>
  <view>
    <name>SpecimenCollectionGroup</name>
    <caption>#getMessage("scg")</caption>
    <table>CATISSUE_SPECIMEN_COLL_GROUP</table>
    <activeCondition>ACTIVITY_STATUS != 'Disabled'</activeCondition>
    <row>
      <numberField>
        <name>id</name>
        <udn>id</udn>
        <caption>#getMessage("scg_identifier")</caption>
        <column>IDENTIFIER</column>
      </numberField>
    </row>
    <row>
      <textField>
        <name>name</name>
        <udn>name</udn>
        <caption>#getMessage("scg_name")</caption>
        <column>NAME</column>
      </textField>
    </row>
    <row>
      <dropDown>
        <name>activityStatus</name>
        <udn>activityStatus</udn>
        <caption>#getMessage("scg_activity_status")</caption>
        <column>ACTIVITY_STATUS</column>
        <options>
          <option><value>Active</value></option>
          <option><value>Disabled</value></option>
          <option><value>Closed</value></option>
        </options>
      </dropDown>
    </row>
    <row>
      <textField>
        <name>barcode</name>
        <udn>barcode</udn>
        <caption>#getMessage("scg_barcode")</caption>
        <column>BARCODE</column>
      </textField>
    </row>
    <row>
      <subForm>
        <name>site</name>
        <udn>site</udn>
        <caption>#getMessage("scg_site")</caption>
        <table>CATISSUE_SITE</table>
        <foreignKey>IDENTIFIER</foreignKey>
        <parentKey>SITE_ID</parentKey>
        <row>
          <dropDown>
            <name>name</name>
            <udn>name</udn>
            <caption>#getMessage("scg_site_name")</caption>
            <column>NAME</column>
            <options>
              <sql>select distinct name from CATISSUE_SITE</sql>
            </options>
          </dropDown>
        </row>
      </subForm>
    </row>
    <row>
      <subForm>
        <name>collectionProtocolEvent</name>
        <udn>collectionProtocolEvent</udn>
        <caption>#getMessage("scg_cpe")</caption>
        <table>CATISSUE_COLL_PROT_EVENT</table>
        <foreignKey>IDENTIFIER</foreignKey>
        <parentKey>COLLECTION_PROTOCOL_EVENT_ID</parentKey>
        <row>
          <textField>
            <name>collectionPointLabel</name>
            <udn>collectionPointLabel</udn>
            <caption>#getMessage("scg_cpe_label")</caption>
            <column>COLLECTION_POINT_LABEL</column>
          </textField>
        </row>
      </subForm>
    </row>
    <row>
      <dropDown>
        <name>collectionStatus</name>
        <udn>collectionStatus</udn>
        <caption>#getMessage("scg_status")</caption>
        <column>COLLECTION_STATUS</column>
        <options>
          <option><value>Pending</value></option>
          <option><value>Complete</value></option>
          <option><value>Incomplete</value></option>
        </options>
      </dropDown>
    </row>
    <row>
      <dropDown>
        <name>clinicalDiagnosis</name>
        <udn>clinicalDiagnosis</udn>
        <caption>#getMessage("scg_clinical_diagnosis")</caption>
        <column>CLINICAL_DIAGNOSIS</column>
        <options>
          <!-- sql>select value from catissue_permissible_value where public_id = 'Clinical_Diagnosis_PID' order by sortorder, value</sql -->
          <sql>select distinct CLINICAL_DIAGNOSIS from CATISSUE_SPECIMEN_COLL_GROUP</sql>
        </options>
      </dropDown>
    </row>
    <row>
      <dropDown>
        <name>clinicalStatus</name>
        <udn>clinicalStatus</udn>
        <caption>#getMessage("scg_clinical_status")</caption>
        <column>CLINICAL_STATUS</column>
        <options>
          <sql>select value from catissue_permissible_value where PUBLIC_ID = '2003988' order by value</sql>
        </options>
      </dropDown>
    </row>
    <row>
      <textField>
        <name>surgicalPathologyNo</name>
        <udn>surgicalPathologyNo</udn>
        <caption>#getMessage("scg_surgical_pathology_number")</caption>
        <column>SURGICAL_PATHOLOGY_NUMBER</column>
        <phi>true</phi>
      </textField>
    </row>
    <row>
      <datePicker>
        <name>collectionDate</name>
        <udn>collectionDate</udn>
        <caption>#getMessage("scg_date")</caption>
        <column>COLLECTION_TIMESTAMP</column>
      </datePicker>
    </row>
    <row>
      <textField>
        <name>spr</name>
        <udn>spr</udn>
        <caption>#getMessage("scg_spr")</caption>
        <column>SPR_NAME</column>
      </textField>
    </row>
    <row>
      <textField>
        <name>comments</name>
        <udn>comments</udn>
        <caption>#getMessage("scg_comments")</caption>
        <column>COMMENTS</column>
      </textField>
    </row>
    <row>
      <subForm>
        <name>specimens</name>
        <udn>specimens</udn>
        <caption>#getMessage("scg_specimens")</caption>
        <table>CATISSUE_SPECIMEN</table>
        <foreignKey>SPECIMEN_COLLECTION_GROUP_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <pathLink>true</pathLink>
        <row>
          <subForm>
            <name>specimenOrders</name>
            <udn>specimenOrders</udn>
            <caption>#getMessage("scg_specimens_order_items")</caption>
            <table>OS_ORDER_ITEMS</table>
            <foreignKey>SPECIMEN_ID</foreignKey>
            <parentKey>IDENTIFIER</parentKey>
            <row>
              <subForm>
                <name>order</name>
                <udn>order</udn>
                <caption>#getMessage("scg_specimens_order_items_order")</caption>
                <table>OS_ORDERS</table>
                <foreignKey>IDENTIFIER</foreignKey>
                <parentKey>ORDER_ID</parentKey>
              </subForm>
            </row>
          </subForm>
        </row>
      </subForm>
    </row>
    <row>
      <subForm>
        <name>extensions</name>
        <udn>extensions</udn>
        <caption>#getMessage("scg_extensions")</caption>
        <table>SCG_EXTN_RECORDS_VIEW</table>
        <foreignKey>SCG_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <pathLink>true</pathLink>
        <extnFkCol>RECORD_ID</extnFkCol>
      </subForm>
    </row>
  </view>
</form>
